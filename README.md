## 塔防游戏（Pixi.js + Webpack）

一个使用 **Pixi.js** 实现的横向战场塔防小游戏，包含网格地图、拖拽布防、敌人寻路与攻击、金币与升级系统、声音和小地图等完整玩法。

---

### 功能概览

- **基础架构**
  - 使用 **Webpack 5 + Babel** 打包前端项目。
  - 使用 **Pixi.js v8** 作为 2D 渲染引擎。
- **画面与地图**
  - 顶部一行用于 **金币显示区域**。
  - 底部是 **武器容器区域**，可拖拽武器到中间战场。
  - 中间战场是可放置武器和敌人行走的 **网格区域**（白色网格线，战场风格背景）。
  - 战场实际宽度大于屏幕，中间区域可 **左右拖拽视野** 浏览整条战线。
  - 右上角有 **缩略小地图**，显示整条战线上的敌人、己方武器位置，以及当前视口范围。
- **单位与战斗**
  - 绿色坦克为 **玩家武器**，可从底部容器拖拽到任意网格。
  - 红色坦克为 **敌人**，从最左侧随机行生成，沿格子向右前进，遇到武器和其他敌人才重新寻路。
  - 双方都有 **血条显示**，被击毁会消失。
  - 玩家坦克会在一定格子范围内自动旋转炮塔并发射子弹攻击敌人。
  - 敌人也会在攻击范围内停止移动、旋转炮塔朝武器开火。
- **金币与成长系统**
  - 顶部显示当前 **金币数量**。
  - 放置武器、升级武器会消耗金币；击杀敌人、卖掉武器获得金币返还。
  - 选中武器后会在其上方显示 **升级 / 卖掉 按钮**，并在按钮上显示消耗 / 获得金币。
  - 升级武器会提升子弹体积、射速与颜色表现；满级后隐藏升级按钮。
- **声音与 UI**
  - 点击“开始游戏”后播放 **背景音乐**。
  - 武器发射子弹有 **开火音效**。
  - 敌人被击毁有 **爆炸音效**。
  - 单独的 **开始菜单界面** 与 **游戏说明界面**。

---

### 运行环境要求

- Node.js：推荐 **16+**（本项目使用 Webpack 5、Pixi.js 8）
- npm：与 Node 版本匹配即可

---

### 安装与启动

1. 安装依赖：

```bash
npm install
```

2. 开发模式启动（带 HMR）：

```bash
npm run dev
```

默认会在 `http://localhost:3000` 打开浏览器。

3. 生产构建：

```bash
npm run build
```

构建产物输出在 `dist/` 目录。

---

### 声音资源

声音文件放在 `src/audio/` 目录下，Webpack 会通过 `copy-webpack-plugin` 自动复制到 `dist/audio/`：

- `src/audio/bg.wav`：背景音乐（循环播放）
- `src/audio/shoot.wav`：武器发射音效
- `src/audio/boom.wav`：敌人死亡爆炸音效

如需替换音效，只需用同名新文件覆盖即可。

---

### 主要目录结构（简要）

- `src/index.js`：入口文件，初始化 Pixi 应用、开始 UI、战场容器、主循环。
- `src/constants.js`：游戏中的所有常量配置（画布大小、格子尺寸、数值平衡等）。
- `src/background.js`：战场背景与网格绘制。
- `src/goldManager.js`：金币显示与小地图绘制与更新。
- `src/weaponContainer.js`：底部武器容器、拖拽放置、升级/卖掉逻辑。
- `src/tank.js`：玩家武器坦克与子弹的实现。
- `src/enemyManager.js`：敌人生成、移动、寻路、攻击、死亡处理。
- `src/gameUI.js`：开始菜单与游戏说明界面。
- `src/soundManager.js`：声音管理器（背景音乐、武器开火、敌人死亡）。
- `src/audio/`：音效资源目录。

---

### 操作说明

- **开始游戏**
  - 打开页面后先进入开始菜单，点击“开始游戏”即可进入战斗。
  - 可先点击“游戏说明”查看玩法简介。
- **布防与战斗**
  - 鼠标左键按住底部绿色坦克图标，拖拽到中间网格区域，松开即可放置武器（消耗金币）。
  - 鼠标移动到中间战场区域按住并左右拖动，可以拖动视野浏览超长战场。
  - 点击已放置的武器，可以在其上方看到“升级 / 卖掉”按钮：
    - 升级会消耗金币，提升武器性能。
    - 卖掉会返还一定金币，并移除该武器。
  - 敌人会从左侧不断生成，沿格子向右移动并根据障碍自动绕路，同时在射程内向武器开火。
  - 击杀敌人会获得金币，用于继续布防和升级。

---

### 常见问题

- **听不到声音？**
  - 确认浏览器标签没有静音，且 `src/audio/` 下存在 `bg.wav / shoot.wav / boom.wav`。
  - 某些浏览器需要用户产生一次交互后才允许播放音频，本项目在点击“开始游戏”时启动背景音乐。
- **构建失败与依赖问题**
  - 如果遇到 Babel 或 Webpack 相关依赖缺失的错误，可以先执行：
    - `rm -rf node_modules package-lock.json`
    - `npm install`

---

### 后续可以扩展的方向

- 新增更多武器种类（不同射程、伤害、攻击模式）。
- 敌人类型扩展（高速单位、装甲单位、空中单位等）。
- 关卡制与波次系统（每一关有不同地形与敌人配置）。
- 设置菜单（音量、静音、画质、难度等）。


